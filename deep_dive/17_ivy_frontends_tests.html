<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ivy Frontend Tests &mdash; Ivy 1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="icon" type="image/png" href="https://github.com/unifyai/unifyai.github.io/blob/master/img/externally_linked/ivy_logo_only.png?raw=true">
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Open Tasks" href="../contributing/4_open_tasks.html" />
    <link rel="prev" title="Ivy Frontends" href="16_ivy_frontends.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Ivy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extensions.html">Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../deep_dive.html">Deep Dive</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="0_navigating_the_code.html">Navigating the Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_function_types.html">Function Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_backend_setting.html">Backend Setting</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_function_wrapping.html">Function Wrapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_arrays.html">Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_containers.html">Containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_data_types.html">Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="7_devices.html">Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="8_inplace_updates.html">Inplace Updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="9_formatting.html">Formatting</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_function_arguments.html">Function Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_submodule_helpers.html">Submodule Helper Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_docstrings.html">Docstrings</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_docstring_examples.html">Docstring Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="14_array_api_tests.html">Array API Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="15_ivy_tests.html">Ivy Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="16_ivy_frontends.html">Ivy Frontends</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Ivy Frontend Tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ivy-tan">ivy.tan()</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ivy-full">ivy.full()</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/activations.html">Activations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/compilation.html">Compilation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/constants.html">Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/creation.html">Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/data_type.html">Data type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/device.html">Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/elementwise.html">Elementwise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/general.html">General</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/gradients.html">Gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/layers.html">Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/linear_algebra.html">Linear algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/losses.html">Losses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/manipulation.html">Manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/meta.html">Meta</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/nest.html">Nest</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/norms.html">Norms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/random.html">Random</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/searching.html">Searching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/set.html">Set</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/sorting.html">Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/statistical.html">Statistical</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/utility.html">Utility</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../data_classes/container.html">Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_classes/array.html">Array</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Framework Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../stateful/initializers.html">Initializers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stateful/converters.html">Converters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stateful/optimizers.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stateful/module.html">Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stateful/layers.html">Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stateful/norms.html">Norms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stateful/activations.html">Activations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stateful/sequential.html">Sequential</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ivy"">Ivy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mech"">Ivy mech</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vision"">Ivy vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../robot"">Ivy robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gym"">Ivy gym</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../memory"">Ivy memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../builder"">Ivy builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../models"">Ivy models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ecosystem"">Ivy ecosystem</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Ivy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../contributing.html">Contributing</a> &raquo;</li>
          <li><a href="../deep_dive.html">Deep Dive</a> &raquo;</li>
      <li>Ivy Frontend Tests</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/deep_dive/17_ivy_frontends_tests.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ivy-frontend-tests">
<h1>Ivy Frontend Tests<a class="headerlink" href="#ivy-frontend-tests" title="Permalink to this heading"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<p>Just like the backend functional API, our frontend functional API has a collection of Ivy tests located in subfolder <a class="reference external" href="https://github.com/unifyai/ivy/tree/0fc4a104e19266fb4a65f5ec52308ff816e85d78/ivy_tests/test_ivy">test_ivy</a>.
In this section of the deep dive we are going to jump into Ivy Frontend Tests!</p>
<p><strong>Writing Ivy Tests</strong></p>
<p>The Ivy tests in this section make use of hypothesis for performing property based testing which is documented in detail in the Ivy Tests section of the Deep Dive.
We assume knowledge of hypothesis data generation strategies and how to implement them for testing.</p>
<p><strong>Important Helper Functions</strong></p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">helpers.test_frontend_function()</span></code> is an important helper function that is designed to do the heavy lifting and make testing Ivy Frontends easy! It is used to test a frontend function for the current backend by comparing the result with the function in the associated framework.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">helpers.dtype_and_values()</span></code> is a convenience function that allows you to generate lists of any dimension and their associated dtype, returned as <code class="code docutils literal notranslate"><span class="pre">(dtype,</span> <span class="pre">list)</span></code>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">helpers.num_positional_args()</span></code> is a convenience function that specifies the number of positional arguments for a particular function.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">helpers.get_shape()</span></code> is a convenience function that allows you to generate an array shape of type <code class="code docutils literal notranslate"><span class="pre">list</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">np_frontend_helpers.where()</span></code> a generation strategy to generate values for NumPy’s optional <code class="code docutils literal notranslate"><span class="pre">where</span></code> argument.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">np_frontend_helpers.test_frontend_function()</span></code> behaves identical to <code class="code docutils literal notranslate"><span class="pre">helpers.test_frontend_function()</span></code> but handles NumPy’s optional <code class="code docutils literal notranslate"><span class="pre">where</span></code> argument</p></li>
</ul>
<p><strong>Useful Notes</strong></p>
<ul class="simple">
<li><p>There are more <code class="code docutils literal notranslate"><span class="pre">dtype</span></code> sets than <code class="code docutils literal notranslate"><span class="pre">valid_float_dtypes</span></code>, there is also <code class="code docutils literal notranslate"><span class="pre">valid_int_dtypes</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid_numeric_dtypes</span></code> and many more! It’s important when writing Ivy Frontend tests to pick the most appropriate <code class="code docutils literal notranslate"><span class="pre">dtype</span></code> set to ensure thorough testing!</p></li>
<li><p>The <code class="code docutils literal notranslate"><span class="pre">test_frontend_function</span></code> argument <code class="code docutils literal notranslate"><span class="pre">fn_tree</span></code> refers to the frontend function’s reference in its native namespace not just the function name. For example <code class="code docutils literal notranslate"><span class="pre">lax.tan</span></code> is needed for some functions in Jax, <code class="code docutils literal notranslate"><span class="pre">nn.functional.relu</span></code> is needed for some functions in PyTorch etc.</p></li>
</ul>
<p>To get a better understanding for writing frontend tests lets run through some examples!</p>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<section id="ivy-tan">
<h3>ivy.tan()<a class="headerlink" href="#ivy-tan" title="Permalink to this heading"></a></h3>
<p><strong>Jax</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ivy_tests/test_ivy/test_frontends/test_jax/test_jax_lax_operators.py</span>
<span class="c1">#tan</span>
<span class="nd">@given</span><span class="p">(</span>
    <span class="n">dtype_and_x</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">dtype_and_values</span><span class="p">(</span><span class="n">available_dtypes</span><span class="o">=</span><span class="n">ivy_jax</span><span class="o">.</span><span class="n">valid_float_dtypes</span><span class="p">),</span>
    <span class="n">as_variable</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">booleans</span><span class="p">(),</span>
    <span class="n">num_positional_args</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">num_positional_args</span><span class="p">(</span>
        <span class="n">fn_name</span><span class="o">=</span><span class="s2">&quot;ivy.functional.frontends.jax.lax.tan&quot;</span>
    <span class="p">),</span>
    <span class="n">native_array</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">booleans</span><span class="p">(),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_jax_lax_tan</span><span class="p">(</span>
    <span class="n">dtype_and_x</span><span class="p">,</span>
    <span class="n">as_variable</span><span class="p">,</span>
    <span class="n">num_positional_args</span><span class="p">,</span>
    <span class="n">native_array</span><span class="p">,</span>
    <span class="n">fw</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">input_dtype</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">dtype_and_x</span>

    <span class="n">helpers</span><span class="o">.</span><span class="n">test_frontend_function</span><span class="p">(</span>
        <span class="n">input_dtypes</span><span class="o">=</span><span class="n">input_dtype</span><span class="p">,</span>
        <span class="n">as_variable_flags</span><span class="o">=</span><span class="n">as_variable</span><span class="p">,</span>
        <span class="n">with_out</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">num_positional_args</span><span class="o">=</span><span class="n">num_positional_args</span><span class="p">,</span>
        <span class="n">native_array_flags</span><span class="o">=</span><span class="n">native_array</span><span class="p">,</span>
        <span class="n">fw</span><span class="o">=</span><span class="n">fw</span><span class="p">,</span>
        <span class="n">frontend</span><span class="o">=</span><span class="s2">&quot;jax&quot;</span><span class="p">,</span>
        <span class="n">fn_tree</span><span class="o">=</span><span class="s2">&quot;lax.tan&quot;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">input_dtype</span><span class="p">),</span>
    <span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>As you can see we generate almost everything we need to test a frontend function within the <code class="code docutils literal notranslate"><span class="pre">&#64;given</span></code> decorator.</p></li>
<li><p>We use <code class="code docutils literal notranslate"><span class="pre">ivy_jax.valid_float_dtypes</span></code> to generate <code class="code docutils literal notranslate"><span class="pre">available_dtypes</span></code>, these are valid <code class="code docutils literal notranslate"><span class="pre">float</span></code> data types specifically for Jax.</p></li>
<li><p>We pass <code class="code docutils literal notranslate"><span class="pre">fn_name</span></code> to <code class="code docutils literal notranslate"><span class="pre">helpers.num_positional_args</span></code> which is used to determine the number of positional arguments for <code class="code docutils literal notranslate"><span class="pre">jax.lax.tan</span></code>.</p></li>
<li><p>We do not generate any values for <code class="code docutils literal notranslate"><span class="pre">fw</span></code>, these values are generated by PyTest and are only passed as an argument to <code class="code docutils literal notranslate"><span class="pre">test_jax_lax_tan()</span></code>.</p></li>
<li><p>We separate the <code class="code docutils literal notranslate"><span class="pre">input_dtype</span></code> and <code class="code docutils literal notranslate"><span class="pre">x</span></code> from <code class="code docutils literal notranslate"><span class="pre">dtype_and_x</span></code> using <code class="code docutils literal notranslate"><span class="pre">input_dtype,</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">dtype_and_x</span></code> which is generated as a tuple.</p></li>
<li><p>We then pass the generated values to <code class="code docutils literal notranslate"><span class="pre">helpers.test_frontend_function</span></code> which tests the frontend function.</p></li>
<li><p>We set <code class="code docutils literal notranslate"><span class="pre">fn_tree</span></code> to <code class="code docutils literal notranslate"><span class="pre">lax.tan</span></code> which is the path to the function in the Jax namespace.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">jax.lax.tan</span></code> does not support <code class="code docutils literal notranslate"><span class="pre">out</span></code> arguments so we set <code class="code docutils literal notranslate"><span class="pre">with_out</span></code> to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p>We cast <code class="code docutils literal notranslate"><span class="pre">x</span></code> as a NumPy array with <code class="code docutils literal notranslate"><span class="pre">np.asarray(x,</span> <span class="pre">dtype=input_dtype)</span></code> whenever the frontend function requires an array as an input. This is because <code class="code docutils literal notranslate"><span class="pre">x</span></code> is generated as type <code class="code docutils literal notranslate"><span class="pre">list</span></code>.</p></li>
<li><p>One last important note is that all helper functions are designed to take keyword arguments only.</p></li>
</ul>
<p><strong>NumPy</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ivy_tests/test_ivy/test_frontends/test_numpy/test_mathematical_functions/test_np_trigonometric_functions.py</span>
<span class="c1">#tan</span>
<span class="nd">@given</span><span class="p">(</span>
<span class="n">dtype_and_x</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">dtype_and_values</span><span class="p">(</span><span class="n">available_dtypes</span><span class="o">=</span><span class="n">ivy_np</span><span class="o">.</span><span class="n">valid_float_dtypes</span><span class="p">),</span>
<span class="n">dtype</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">sampled_from</span><span class="p">(</span><span class="n">ivy_np</span><span class="o">.</span><span class="n">valid_float_dtypes</span> <span class="o">+</span> <span class="p">(</span><span class="kc">None</span><span class="p">,)),</span>
<span class="n">where</span><span class="o">=</span><span class="n">np_frontend_helpers</span><span class="o">.</span><span class="n">where</span><span class="p">(),</span>
<span class="n">as_variable</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">array_bools</span><span class="p">(),</span>
<span class="n">with_out</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">booleans</span><span class="p">(),</span>
<span class="n">num_positional_args</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">num_positional_args</span><span class="p">(</span>
    <span class="n">fn_name</span><span class="o">=</span><span class="s2">&quot;ivy.functional.frontends.numpy.tan&quot;</span>
<span class="p">),</span>
<span class="n">native_array</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">array_bools</span><span class="p">(),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_numpy_tan</span><span class="p">(</span>
    <span class="n">dtype_and_x</span><span class="p">,</span>
    <span class="n">dtype</span><span class="p">,</span>
    <span class="n">where</span><span class="p">,</span>
    <span class="n">as_variable</span><span class="p">,</span>
    <span class="n">with_out</span><span class="p">,</span>
    <span class="n">num_positional_args</span><span class="p">,</span>
    <span class="n">native_array</span><span class="p">,</span>
    <span class="n">fw</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">input_dtype</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">dtype_and_x</span>
    <span class="n">input_dtype</span> <span class="o">=</span> <span class="p">[</span><span class="n">input_dtype</span><span class="p">]</span>
    <span class="n">where</span> <span class="o">=</span> <span class="n">np_frontend_helpers</span><span class="o">.</span><span class="n">handle_where_and_array_bools</span><span class="p">(</span>
        <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span>
        <span class="n">input_dtype</span><span class="o">=</span><span class="n">input_dtype</span><span class="p">,</span>
        <span class="n">as_variable</span><span class="o">=</span><span class="n">as_variable</span><span class="p">,</span>
        <span class="n">native_array</span><span class="o">=</span><span class="n">native_array</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">np_frontend_helpers</span><span class="o">.</span><span class="n">test_frontend_function</span><span class="p">(</span>
        <span class="n">input_dtypes</span><span class="o">=</span><span class="n">input_dtype</span><span class="p">,</span>
        <span class="n">as_variable_flags</span><span class="o">=</span><span class="n">as_variable</span><span class="p">,</span>
        <span class="n">with_out</span><span class="o">=</span><span class="n">with_out</span><span class="p">,</span>
        <span class="n">num_positional_args</span><span class="o">=</span><span class="n">num_positional_args</span><span class="p">,</span>
        <span class="n">native_array_flags</span><span class="o">=</span><span class="n">native_array</span><span class="p">,</span>
        <span class="n">fw</span><span class="o">=</span><span class="n">fw</span><span class="p">,</span>
        <span class="n">frontend</span><span class="o">=</span><span class="s2">&quot;numpy&quot;</span><span class="p">,</span>
        <span class="n">fn_tree</span><span class="o">=</span><span class="s2">&quot;tan&quot;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">input_dtype</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span>
        <span class="n">casting</span><span class="o">=</span><span class="s2">&quot;same_kind&quot;</span><span class="p">,</span>
        <span class="n">order</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
        <span class="n">subok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">test_values</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Here we use <code class="code docutils literal notranslate"><span class="pre">ivy_np.valid_float_dtypes()</span></code> to generate <code class="code docutils literal notranslate"><span class="pre">available_dtypes</span></code>, these are valid <code class="code docutils literal notranslate"><span class="pre">float</span></code> data types specifically for NumPy.</p></li>
<li><p>NumPy has an optional argument <code class="code docutils literal notranslate"><span class="pre">where</span></code> which is generated using <code class="code docutils literal notranslate"><span class="pre">np_frontend_helpers.where()</span></code>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">numpy.tan()</span></code> supports <code class="code docutils literal notranslate"><span class="pre">out</span></code> arguments so we set generate values for <code class="code docutils literal notranslate"><span class="pre">with_out</span></code>.</p></li>
<li><p>Using <code class="code docutils literal notranslate"><span class="pre">np_frontend_helpers.handle_where_and_array_bools()</span></code> we do some processing on the generated <code class="code docutils literal notranslate"><span class="pre">where</span></code> value.</p></li>
<li><p>Instead of <code class="code docutils literal notranslate"><span class="pre">helpers.test_frontend_function()</span></code> we use <code class="code docutils literal notranslate"><span class="pre">np_frontend_helpers.test_frontend_function()</span></code> which behaves the same but has some extra code to handle the <code class="code docutils literal notranslate"><span class="pre">where</span></code> argument.</p></li>
<li><p>We set <code class="code docutils literal notranslate"><span class="pre">fn_tree</span></code> to <code class="code docutils literal notranslate"><span class="pre">tan</span></code> which is the path to the function in the NumPy namespace.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">casting</span></code>, <code class="code docutils literal notranslate"><span class="pre">order</span></code>, <code class="code docutils literal notranslate"><span class="pre">subok</span></code> and <code class="code docutils literal notranslate"><span class="pre">test_values</span></code> are other other optional arguments for <code class="code docutils literal notranslate"><span class="pre">numpy.tan()</span></code>.</p></li>
</ul>
<p><strong>TensorFlow</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ivy_tests/test_ivy/test_frontends/test_tensorflow/test_tf_functions.py</span>
<span class="c1">#tan</span>
<span class="nd">@given</span><span class="p">(</span>
<span class="n">dtype_and_x</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">dtype_and_values</span><span class="p">(</span><span class="n">available_dtypes</span><span class="o">=</span><span class="n">ivy_tf</span><span class="o">.</span><span class="n">valid_float_dtypes</span><span class="p">),</span>
<span class="n">as_variable</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">booleans</span><span class="p">(),</span>
<span class="n">num_positional_args</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">num_positional_args</span><span class="p">(</span>
    <span class="n">fn_name</span><span class="o">=</span><span class="s2">&quot;ivy.functional.frontends.tensorflow.tan&quot;</span>
<span class="p">),</span>
<span class="n">native_array</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">booleans</span><span class="p">(),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_tensorflow_tan</span><span class="p">(</span>
    <span class="n">dtype_and_x</span><span class="p">,</span> <span class="n">as_variable</span><span class="p">,</span> <span class="n">num_positional_args</span><span class="p">,</span> <span class="n">native_array</span><span class="p">,</span> <span class="n">fw</span>
<span class="p">):</span>
    <span class="n">input_dtype</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">dtype_and_x</span>
    <span class="n">helpers</span><span class="o">.</span><span class="n">test_frontend_function</span><span class="p">(</span>
        <span class="n">input_dtypes</span><span class="o">=</span><span class="n">input_dtype</span><span class="p">,</span>
        <span class="n">as_variable_flags</span><span class="o">=</span><span class="n">as_variable</span><span class="p">,</span>
        <span class="n">with_out</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">num_positional_args</span><span class="o">=</span><span class="n">num_positional_args</span><span class="p">,</span>
        <span class="n">native_array_flags</span><span class="o">=</span><span class="n">native_array</span><span class="p">,</span>
        <span class="n">fw</span><span class="o">=</span><span class="n">fw</span><span class="p">,</span>
        <span class="n">frontend</span><span class="o">=</span><span class="s2">&quot;tensorflow&quot;</span><span class="p">,</span>
        <span class="n">fn_tree</span><span class="o">=</span><span class="s2">&quot;tan&quot;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">input_dtype</span><span class="p">),</span>
    <span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>We use <code class="code docutils literal notranslate"><span class="pre">ivy_tf.valid_float_dtypes</span></code> to generate <code class="code docutils literal notranslate"><span class="pre">available_dtypes</span></code>, these are valid <code class="code docutils literal notranslate"><span class="pre">float</span></code> data types specifically for TensorFlow.</p></li>
<li><p>We set <code class="code docutils literal notranslate"><span class="pre">fn_tree</span></code> to <code class="code docutils literal notranslate"><span class="pre">tan</span></code> which is the path to the function in the TensorFlow namespace.</p></li>
</ul>
<p><strong>PyTorch</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ivy_tests/test_ivy/test_frontends/test_torch/test_pointwise_ops.py</span>
<span class="c1">#tan</span>
<span class="nd">@given</span><span class="p">(</span>
<span class="n">dtype_and_x</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">dtype_and_values</span><span class="p">(</span>
    <span class="n">available_dtypes</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span>
        <span class="nb">set</span><span class="p">(</span><span class="n">ivy_np</span><span class="o">.</span><span class="n">valid_float_dtypes</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span>
            <span class="nb">set</span><span class="p">(</span><span class="n">ivy_torch</span><span class="o">.</span><span class="n">valid_float_dtypes</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">),</span>
<span class="n">as_variable</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">booleans</span><span class="p">(),</span>
<span class="n">with_out</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">booleans</span><span class="p">(),</span>
<span class="n">num_positional_args</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">num_positional_args</span><span class="p">(</span>
    <span class="n">fn_name</span><span class="o">=</span><span class="s2">&quot;functional.frontends.torch.tan&quot;</span>
<span class="p">),</span>
<span class="n">native_array</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">booleans</span><span class="p">(),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_torch_tan</span><span class="p">(</span>
    <span class="n">dtype_and_x</span><span class="p">,</span>
    <span class="n">as_variable</span><span class="p">,</span>
    <span class="n">with_out</span><span class="p">,</span>
    <span class="n">num_positional_args</span><span class="p">,</span>
    <span class="n">native_array</span><span class="p">,</span>
    <span class="n">fw</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">input_dtype</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">dtype_and_x</span>
    <span class="n">helpers</span><span class="o">.</span><span class="n">test_frontend_function</span><span class="p">(</span>
        <span class="n">input_dtypes</span><span class="o">=</span><span class="n">input_dtype</span><span class="p">,</span>
        <span class="n">as_variable_flags</span><span class="o">=</span><span class="n">as_variable</span><span class="p">,</span>
        <span class="n">with_out</span><span class="o">=</span><span class="n">with_out</span><span class="p">,</span>
        <span class="n">num_positional_args</span><span class="o">=</span><span class="n">num_positional_args</span><span class="p">,</span>
        <span class="n">native_array_flags</span><span class="o">=</span><span class="n">native_array</span><span class="p">,</span>
        <span class="n">fw</span><span class="o">=</span><span class="n">fw</span><span class="p">,</span>
        <span class="n">frontend</span><span class="o">=</span><span class="s2">&quot;torch&quot;</span><span class="p">,</span>
        <span class="n">fn_tree</span><span class="o">=</span><span class="s2">&quot;tan&quot;</span><span class="p">,</span>
        <span class="nb">input</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">input_dtype</span><span class="p">),</span>
        <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>We use <code class="code docutils literal notranslate"><span class="pre">ivy_tf.valid_float_dtypes</span></code> to generate <code class="code docutils literal notranslate"><span class="pre">available_dtypes</span></code>, these are valid <code class="code docutils literal notranslate"><span class="pre">float</span></code> data types specifically for TensorFlow.</p></li>
<li><p>We set <code class="code docutils literal notranslate"><span class="pre">fn_tree</span></code> to <code class="code docutils literal notranslate"><span class="pre">tan</span></code> which is the path to the function in the PyTorch namespace.</p></li>
<li><p>Torch accepts both Torch and NumPy data-types so we create a <code class="code docutils literal notranslate"><span class="pre">tuple</span></code> of the two as <code class="code docutils literal notranslate"><span class="pre">available_dtypes</span></code>.</p></li>
</ul>
</section>
<section id="ivy-full">
<h3>ivy.full()<a class="headerlink" href="#ivy-full" title="Permalink to this heading"></a></h3>
<p>Here we are going to look at an example of a function that does not consume an <code class="code docutils literal notranslate"><span class="pre">array</span></code>.
This is the creation function <code class="code docutils literal notranslate"><span class="pre">full()</span></code>, which takes an array shape as an argument to create an array and filled with elements of a given value.
This function requires us to create extra functions for generating <code class="code docutils literal notranslate"><span class="pre">shape</span></code> and <code class="code docutils literal notranslate"><span class="pre">fill</span> <span class="pre">value</span></code>, these use the <code class="code docutils literal notranslate"><span class="pre">shared</span></code> hypothesis strategy.</p>
<p><strong>Jax</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ivy_tests/test_ivy/test_frontends/test_jax/test_jax_lax_operators.py</span>
<span class="c1"># full</span>
<span class="nd">@st</span><span class="o">.</span><span class="n">composite</span>
<span class="k">def</span> <span class="nf">_dtypes</span><span class="p">(</span><span class="n">draw</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">draw</span><span class="p">(</span>
        <span class="n">st</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span>
            <span class="n">helpers</span><span class="o">.</span><span class="n">list_of_length</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">sampled_from</span><span class="p">(</span><span class="n">ivy_jax</span><span class="o">.</span><span class="n">valid_numeric_dtypes</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">),</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;dtype&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>


<span class="nd">@st</span><span class="o">.</span><span class="n">composite</span>
<span class="k">def</span> <span class="nf">_fill_value</span><span class="p">(</span><span class="n">draw</span><span class="p">):</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span><span class="n">_dtypes</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_uint_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">ints</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_int_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">ints</span><span class="p">(</span><span class="n">min_value</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">floats</span><span class="p">(</span><span class="n">min_value</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>


<span class="nd">@given</span><span class="p">(</span>
    <span class="n">shape</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">get_shape</span><span class="p">(</span>
        <span class="n">allow_none</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">min_num_dims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">max_num_dims</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">min_dim_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">max_dim_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">fill_value</span><span class="o">=</span><span class="n">_fill_value</span><span class="p">(),</span>
    <span class="n">dtypes</span><span class="o">=</span><span class="n">_dtypes</span><span class="p">(),</span>
    <span class="n">num_positional_args</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">num_positional_args</span><span class="p">(</span>
        <span class="n">fn_name</span><span class="o">=</span><span class="s2">&quot;ivy.functional.frontends.jax.lax.full&quot;</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_jax_lax_full</span><span class="p">(</span>
    <span class="n">shape</span><span class="p">,</span>
    <span class="n">fill_value</span><span class="p">,</span>
    <span class="n">dtypes</span><span class="p">,</span>
    <span class="n">num_positional_args</span><span class="p">,</span>
    <span class="n">fw</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">helpers</span><span class="o">.</span><span class="n">test_frontend_function</span><span class="p">(</span>
        <span class="n">input_dtypes</span><span class="o">=</span><span class="n">dtypes</span><span class="p">,</span>
        <span class="n">as_variable_flags</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">with_out</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">num_positional_args</span><span class="o">=</span><span class="n">num_positional_args</span><span class="p">,</span>
        <span class="n">native_array_flags</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fw</span><span class="o">=</span><span class="n">fw</span><span class="p">,</span>
        <span class="n">frontend</span><span class="o">=</span><span class="s2">&quot;jax&quot;</span><span class="p">,</span>
        <span class="n">fn_tree</span><span class="o">=</span><span class="s2">&quot;lax.full&quot;</span><span class="p">,</span>
        <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
        <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">,</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">dtypes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The first extra function we use is <code class="code docutils literal notranslate"><span class="pre">_dtypes</span></code> which generates a <code class="code docutils literal notranslate"><span class="pre">list</span></code> of <code class="code docutils literal notranslate"><span class="pre">dtypes</span></code> to use for the <code class="code docutils literal notranslate"><span class="pre">dtype</span></code> argument. Notice how we use <code class="code docutils literal notranslate"><span class="pre">st.shared</span></code> to generate a dtype which is unique to that test instance.</p></li>
<li><p>The second extra function we use is <code class="code docutils literal notranslate"><span class="pre">_fill_value</span></code> which generates a <code class="code docutils literal notranslate"><span class="pre">fill_value</span></code> to use for the <code class="code docutils literal notranslate"><span class="pre">fill_value</span></code> argument but handles the complications of <code class="code docutils literal notranslate"><span class="pre">int</span></code> and <code class="code docutils literal notranslate"><span class="pre">uint</span></code> types correctly</p></li>
<li><p>We use the helper function <code class="code docutils literal notranslate"><span class="pre">helpers.get_shape()</span></code> to generate <code class="code docutils literal notranslate"><span class="pre">shape</span></code>.</p></li>
<li><p>We use <code class="code docutils literal notranslate"><span class="pre">ivy_jax.valid_numeric_dtypes</span></code> to generate <code class="code docutils literal notranslate"><span class="pre">dtype</span></code>, these are valid numeric data types specifically for Jax. This is used to specify the data type of the output array.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">full()</span></code> does not consume <code class="code docutils literal notranslate"><span class="pre">array</span></code>, we set <code class="code docutils literal notranslate"><span class="pre">as_variable_flags</span></code>, <code class="code docutils literal notranslate"><span class="pre">with_out</span></code> and <code class="code docutils literal notranslate"><span class="pre">native_array_flags</span></code> to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
<p><strong>NumPy</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ivy_tests/test_ivy/test_frontends/test_numpy/creation_routines/test_from_shape_or_value.py</span>
<span class="c1"># full</span>
<span class="nd">@st</span><span class="o">.</span><span class="n">composite</span>
<span class="k">def</span> <span class="nf">_dtypes</span><span class="p">(</span><span class="n">draw</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">draw</span><span class="p">(</span>
        <span class="n">st</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span>
            <span class="n">helpers</span><span class="o">.</span><span class="n">list_of_length</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">sampled_from</span><span class="p">(</span><span class="n">ivy_np</span><span class="o">.</span><span class="n">valid_numeric_dtypes</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">),</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;dtype&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>


<span class="nd">@st</span><span class="o">.</span><span class="n">composite</span>
<span class="k">def</span> <span class="nf">_fill_value</span><span class="p">(</span><span class="n">draw</span><span class="p">):</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span><span class="n">_dtypes</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_uint_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">ints</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_int_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">ints</span><span class="p">(</span><span class="n">min_value</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">floats</span><span class="p">(</span><span class="n">min_value</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>


<span class="nd">@given</span><span class="p">(</span>
    <span class="n">shape</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">get_shape</span><span class="p">(</span>
        <span class="n">allow_none</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">min_num_dims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">max_num_dims</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">min_dim_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">max_dim_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">fill_value</span><span class="o">=</span><span class="n">_fill_value</span><span class="p">(),</span>
    <span class="n">dtypes</span><span class="o">=</span><span class="n">_dtypes</span><span class="p">(),</span>
    <span class="n">num_positional_args</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">num_positional_args</span><span class="p">(</span>
        <span class="n">fn_name</span><span class="o">=</span><span class="s2">&quot;ivy.functional.frontends.numpy.full&quot;</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_numpy_full</span><span class="p">(</span>
    <span class="n">shape</span><span class="p">,</span>
    <span class="n">fill_value</span><span class="p">,</span>
    <span class="n">dtypes</span><span class="p">,</span>
    <span class="n">num_positional_args</span><span class="p">,</span>
    <span class="n">fw</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">helpers</span><span class="o">.</span><span class="n">test_frontend_function</span><span class="p">(</span>
        <span class="n">input_dtypes</span><span class="o">=</span><span class="n">dtypes</span><span class="p">,</span>
        <span class="n">as_variable_flags</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">with_out</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">num_positional_args</span><span class="o">=</span><span class="n">num_positional_args</span><span class="p">,</span>
        <span class="n">native_array_flags</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fw</span><span class="o">=</span><span class="n">fw</span><span class="p">,</span>
        <span class="n">frontend</span><span class="o">=</span><span class="s2">&quot;numpy&quot;</span><span class="p">,</span>
        <span class="n">fn_tree</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">,</span>
        <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
        <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">,</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">dtypes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>We use <code class="code docutils literal notranslate"><span class="pre">ivy_np.valid_numeric_dtypes</span></code> to generate <code class="code docutils literal notranslate"><span class="pre">dtype</span></code>, these are valid numeric data types specifically for NumPy.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">numpy.full()</span></code> does not have a <code class="code docutils literal notranslate"><span class="pre">where</span></code> argument so we can use <code class="code docutils literal notranslate"><span class="pre">helpers.test_frontend_function()</span></code></p></li>
</ul>
<p><strong>TensorFlow</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ivy_tests/test_ivy/test_frontends/test_tensorflow/test_tf_functions.py</span>
<span class="c1"># full</span>
<span class="nd">@st</span><span class="o">.</span><span class="n">composite</span>
<span class="k">def</span> <span class="nf">_dtypes</span><span class="p">(</span><span class="n">draw</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">draw</span><span class="p">(</span>
        <span class="n">st</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span>
            <span class="n">helpers</span><span class="o">.</span><span class="n">list_of_length</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">sampled_from</span><span class="p">(</span><span class="n">ivy_tf</span><span class="o">.</span><span class="n">valid_numeric_dtypes</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">),</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;dtype&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>


<span class="nd">@st</span><span class="o">.</span><span class="n">composite</span>
<span class="k">def</span> <span class="nf">_fill_value</span><span class="p">(</span><span class="n">draw</span><span class="p">):</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span><span class="n">_dtypes</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_uint_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">ints</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_int_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">ints</span><span class="p">(</span><span class="n">min_value</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">floats</span><span class="p">(</span><span class="n">min_value</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>


<span class="nd">@given</span><span class="p">(</span>
    <span class="n">shape</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">get_shape</span><span class="p">(</span>
        <span class="n">allow_none</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">min_num_dims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">max_num_dims</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">min_dim_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">max_dim_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">fill_value</span><span class="o">=</span><span class="n">_fill_value</span><span class="p">(),</span>
    <span class="n">dtypes</span><span class="o">=</span><span class="n">_dtypes</span><span class="p">(),</span>
    <span class="n">num_positional_args</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">num_positional_args</span><span class="p">(</span>
        <span class="n">fn_name</span><span class="o">=</span><span class="s2">&quot;ivy.functional.frontends.tensorflow.fill&quot;</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_tensorflow_full</span><span class="p">(</span>
    <span class="n">shape</span><span class="p">,</span>
    <span class="n">fill_value</span><span class="p">,</span>
    <span class="n">dtypes</span><span class="p">,</span>
    <span class="n">num_positional_args</span><span class="p">,</span>
    <span class="n">fw</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">helpers</span><span class="o">.</span><span class="n">test_frontend_function</span><span class="p">(</span>
        <span class="n">input_dtypes</span><span class="o">=</span><span class="n">dtypes</span><span class="p">,</span>
        <span class="n">as_variable_flags</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">with_out</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">num_positional_args</span><span class="o">=</span><span class="n">num_positional_args</span><span class="p">,</span>
        <span class="n">native_array_flags</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fw</span><span class="o">=</span><span class="n">fw</span><span class="p">,</span>
        <span class="n">frontend</span><span class="o">=</span><span class="s2">&quot;tensorflow&quot;</span><span class="p">,</span>
        <span class="n">fn_tree</span><span class="o">=</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span>
        <span class="n">dims</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">,</span>
        <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>We use <code class="code docutils literal notranslate"><span class="pre">ivy_tf.valid_numeric_dtypes</span></code> to generate <code class="code docutils literal notranslate"><span class="pre">dtype</span></code>, these are valid numeric data types specifically for TensorFlow.</p></li>
<li><p>Tensorflow’s version of <code class="code docutils literal notranslate"><span class="pre">full()</span></code> is named <code class="code docutils literal notranslate"><span class="pre">fill()</span></code> therefore we specify the <code class="code docutils literal notranslate"><span class="pre">fn_tree</span></code> argument to be <code class="code docutils literal notranslate"><span class="pre">&quot;fill&quot;</span></code></p></li>
<li><p>When running the test there where some small discrepancies between the values so we can use <code class="code docutils literal notranslate"><span class="pre">rtol</span></code> to specify the relative tolerance.</p></li>
</ul>
<p><strong>PyTorch</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ivy_tests/test_ivy/test_frontends/test_torch/test_creation_ops.py</span>
<span class="c1"># full</span>
<span class="nd">@st</span><span class="o">.</span><span class="n">composite</span>
<span class="k">def</span> <span class="nf">_dtypes</span><span class="p">(</span><span class="n">draw</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">draw</span><span class="p">(</span>
        <span class="n">st</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span>
            <span class="n">helpers</span><span class="o">.</span><span class="n">list_of_length</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">sampled_from</span><span class="p">(</span><span class="n">ivy_torch</span><span class="o">.</span><span class="n">valid_numeric_dtypes</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">),</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;dtype&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>


<span class="nd">@st</span><span class="o">.</span><span class="n">composite</span>
<span class="k">def</span> <span class="nf">_fill_value</span><span class="p">(</span><span class="n">draw</span><span class="p">):</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span><span class="n">_dtypes</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_uint_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">ints</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_int_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">ints</span><span class="p">(</span><span class="n">min_value</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">helpers</span><span class="o">.</span><span class="n">floats</span><span class="p">(</span><span class="n">min_value</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>


<span class="nd">@st</span><span class="o">.</span><span class="n">composite</span>
<span class="k">def</span> <span class="nf">_requires_grad</span><span class="p">(</span><span class="n">draw</span><span class="p">):</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span><span class="n">_dtypes</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_int_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_uint_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">just</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">booleans</span><span class="p">())</span>


<span class="c1"># full</span>
<span class="nd">@given</span><span class="p">(</span>
    <span class="n">shape</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">get_shape</span><span class="p">(</span>
        <span class="n">allow_none</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">min_num_dims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">max_num_dims</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">min_dim_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">max_dim_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">fill_value</span><span class="o">=</span><span class="n">_fill_value</span><span class="p">(),</span>
    <span class="n">dtypes</span><span class="o">=</span><span class="n">_dtypes</span><span class="p">(),</span>
    <span class="n">requires_grad</span><span class="o">=</span><span class="n">_requires_grad</span><span class="p">(),</span>
    <span class="n">num_positional_args</span><span class="o">=</span><span class="n">helpers</span><span class="o">.</span><span class="n">num_positional_args</span><span class="p">(</span>
        <span class="n">fn_name</span><span class="o">=</span><span class="s2">&quot;ivy.functional.frontends.torch.full&quot;</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_torch_full</span><span class="p">(</span>
    <span class="n">shape</span><span class="p">,</span>
    <span class="n">fill_value</span><span class="p">,</span>
    <span class="n">dtypes</span><span class="p">,</span>
    <span class="n">requires_grad</span><span class="p">,</span>
    <span class="n">device</span><span class="p">,</span>
    <span class="n">num_positional_args</span><span class="p">,</span>
    <span class="n">fw</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">helpers</span><span class="o">.</span><span class="n">test_frontend_function</span><span class="p">(</span>
        <span class="n">input_dtypes</span><span class="o">=</span><span class="n">dtypes</span><span class="p">,</span>
        <span class="n">as_variable_flags</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">with_out</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">num_positional_args</span><span class="o">=</span><span class="n">num_positional_args</span><span class="p">,</span>
        <span class="n">native_array_flags</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fw</span><span class="o">=</span><span class="n">fw</span><span class="p">,</span>
        <span class="n">frontend</span><span class="o">=</span><span class="s2">&quot;torch&quot;</span><span class="p">,</span>
        <span class="n">fn_tree</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
        <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">,</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">dtypes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
        <span class="n">requires_grad</span><span class="o">=</span><span class="n">requires_grad</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Here we created another extra function, <code class="code docutils literal notranslate"><span class="pre">_requires_grad()</span></code>, to accommodate the <code class="code docutils literal notranslate"><span class="pre">requires_grad</span></code> argument. This is because when the dtype is an integer or unsigned integer the <code class="code docutils literal notranslate"><span class="pre">requires_grad</span></code> argument is not supported.</p></li>
<li><p>We use <code class="code docutils literal notranslate"><span class="pre">ivy_torch.valid_numeric_dtypes</span></code> to generate <code class="code docutils literal notranslate"><span class="pre">dtype</span></code>, these are valid numeric data types specifically for Torch.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">torch.full()</span></code> supports <code class="code docutils literal notranslate"><span class="pre">out</span></code> so we generate <code class="code docutils literal notranslate"><span class="pre">with_out</span></code>.</p></li>
</ul>
<p><strong>Round Up</strong></p>
<p>These examples have hopefully given you a good understanding of Ivy Frontend Tests!</p>
<p>If you’re ever unsure of how best to proceed,
please feel free to engage with the <a class="reference external" href="https://github.com/unifyai/ivy/discussions/2051">ivy frontends discussion</a>,
or reach out on <a class="reference external" href="https://discord.gg/ZVQdvbzNQJ">discord</a> in the <a class="reference external" href="https://discord.com/channels/799879767196958751/998782045494976522">ivy frontends channel</a>!</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="16_ivy_frontends.html" class="btn btn-neutral float-left" title="Ivy Frontends" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../contributing/4_open_tasks.html" class="btn btn-neutral float-right" title="Open Tasks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2022, Ivy Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>